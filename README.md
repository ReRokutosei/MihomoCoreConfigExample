# Mihomo è£¸æ ¸é…ç½®

> [!CAUTION]
> **å£°æ˜**
> 
> 1. æœ¬é¡¹ç›®**ä»…ä¾›å…·å¤‡ç½‘ç»œæŠ€æœ¯åŸºç¡€çš„äººå‘˜ç ”ç©¶å’Œå­¦ä¹ ä½¿ç”¨**ï¼Œæ™®é€šç”¨æˆ·è¯·å‹¿è½»æ˜“å°è¯•
> 2. æœ¬é¡¹ç›®æŒ‰"ç°çŠ¶"æä¾›ï¼Œä¸æä¾›ä»»ä½•å½¢å¼çš„æ‹…ä¿ã€æŠ€æœ¯æ”¯æŒæˆ–ä½¿ç”¨æŒ‡å¯¼
> 3. **ä½œè€…ä¸å¯¹å› ä½¿ç”¨æœ¬é¡¹ç›®è€Œå¯¼è‡´çš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå¤±æ‰¿æ‹…ä»»ä½•è´£ä»»**ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç½‘ç»œæ•…éšœã€æ•°æ®ä¸¢å¤±ã€è®¾å¤‡æŸåç­‰
> 4. æœ¬é¡¹ç›®ä¸æ¥å—ä»»ä½•å½¢å¼çš„ Pull Requestï¼Œä¸æ‰¿è¯ºå¤„ç†ä»»ä½• Issueï¼Œ**ä½œè€…ä¿ç•™éšæ—¶åˆ é™¤ä»“åº“çš„æƒåˆ©ä¸”æ— éœ€æå‰é€šçŸ¥**
> 5. æœ¬é¡¹ç›®ä¸­çš„å›¾æ ‡æ–‡ä»¶ï¼ˆconfig/ui/iconsç›®å½•ä¸‹æ‰€æœ‰PNGæ–‡ä»¶ï¼‰æ¥æºäºæ¸¸æˆã€Šå´©åï¼šæ˜Ÿç©¹é“é“ã€‹ï¼Œç‰ˆæƒå½’åŸæƒåˆ©äººç±³å“ˆæ¸¸æ‰€æœ‰ï¼Œä¸¥ç¦ç”¨äºå•†ä¸šç”¨é€”
> 6. **ä¸¥ç¦å°†æœ¬é¡¹ç›®ç”¨äºä»»ä½•è‰²æƒ…ã€æ”¿æ²»ã€å®—æ•™æˆ–è¿æ³•çŠ¯ç½ªç›®çš„ï¼Œå¦‚æœ‰è¿åï¼Œä½¿ç”¨è€…å°†æ‰¿æ‹…å…¨éƒ¨æ³•å¾‹è´£ä»»ï¼Œä¸ä»“åº“ä½œè€…æ— å…³**
> 7. **ä»»ä½•å› ä½¿ç”¨æœ¬é¡¹ç›®è€Œäº§ç”Ÿçš„æ³•å¾‹çº çº·ã€è¡Œæ”¿å¤„ç½šæˆ–å…¶ä»–åæœå‡ç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…å…¨éƒ¨è´£ä»»ï¼Œä½œè€…å¯¹æ­¤ä¸æ‰¿æ‹…ä»»ä½•è¿å¸¦è´£ä»»**
> 8. **ä¸€æ—¦ä½¿ç”¨æœ¬é¡¹ç›®ï¼Œå³è§†ä¸ºç†è§£å¹¶åŒæ„ä¸Šè¿°æ‰€æœ‰å£°æ˜ï¼Œå¦‚æœ‰å¼‚è®®è¯·ç«‹å³åœæ­¢ä½¿ç”¨å¹¶åˆ é™¤ç›¸å…³æ–‡ä»¶**

<div align="center">

**æœ¬ä»“åº“æä¾›äº†ä¸€å¥—å®Œæ•´çš„ Mihomo è£¸æ ¸è¿è¡Œé…ç½®ï¼ˆæœªåŒ…å«èŠ‚ç‚¹ä¾›åº”ï¼‰**

</div>

## å‰ç½®ä¸‹è½½
1. ä¸‹è½½ [Mihomoæ ¸å¿ƒ(amd64 v3)](https://github.com/MetaCubeX/mihomo/releases/latest) æ”¾è‡³æ ¹ç›®å½•
2. ä¸‹è½½ [WinSW](https://github.com/winsw/winsw/releases) æ”¾è‡³ `script\winsw.exe`
  - NSSM å·²äº2017å¹´åœæ­¢æ›´æ–°ï¼Œæˆ‘ä¸å–œæ¬¢å…¶å¤è€çš„ç•Œé¢ï¼›
  - WinSW ä¹Ÿäº2023åœæ­¢æ›´æ–°(Author: `I have no time to maintain WinSW at the moment`)ï¼Œä½†å®ƒç¬¦åˆæˆ‘çš„éœ€æ±‚

## ç›®å½•ç»“æ„

```
â”œâ”€â”€ config/                               # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ main.yaml                         # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ ASN.mmdb                          # ASN æ•°æ®åº“
â”‚   â”œâ”€â”€ GeoSite.dat                       # GeoSite æ•°æ®åº“
â”‚   â”œâ”€â”€ otherfiles/                       # å‚è€ƒé…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ proxy_provider/                   # ä»£ç†æä¾›å•†é…ç½®
â”‚   â”œâ”€â”€ ui/                               # Web UI (Zashboard)
â”‚   â”œâ”€â”€ config/ui/icons                   # è‡ªå®šä¹‰å›¾æ ‡(æ¥è‡ªå´©åï¼šæ˜Ÿç©¹é“é“)
â”‚   â””â”€â”€ rule_set/                         # è§„åˆ™é›†æ–‡ä»¶
â”œâ”€â”€ mihomo-windows-amd64-v3.exe           # Mihomo æ ¸å¿ƒå¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ script/                               # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ restart-mihomo.ps1                # é‡å¯æ ¸å¿ƒçš„å¿«é€Ÿè„šæœ¬
â”‚   â”œâ”€â”€ start-mihomo.ps1                  # å¯åŠ¨æ ¸å¿ƒçš„å¿«é€Ÿè„šæœ¬
â”‚   â”œâ”€â”€ stop-mihomo.ps1                   # åœæ­¢æ ¸å¿ƒçš„å¿«é€Ÿè„šæœ¬
â”‚   â”œâ”€â”€ sync-official-config.ps1          # åŒæ­¥å®˜æ–¹ç¤ºä¾‹é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ sync-official-config-run.vbs      # è¾…åŠ©è„šæœ¬
â”‚   â”œâ”€â”€ sync-procider.ps1                 # ç»Ÿè®¡èŠ‚ç‚¹æ•°é‡å˜åŠ¨æƒ…å†µ
â”‚   â”œâ”€â”€ sync-procider-run.vbs             # è¾…åŠ©è„šæœ¬
â”‚   â”œâ”€â”€ Sync Mihomo Official Config.xml   # è®¡æ—¶ä»»åŠ¡ç¤ºä¾‹
â”‚   â”œâ”€â”€ Sync Procider.xml                 # è®¡æ—¶ä»»åŠ¡ç¤ºä¾‹
â”‚   â”œâ”€â”€ winsw.exe                         # Windows Service Wrapper
â”‚   â”œâ”€â”€ winsw.xml                         # Windows Service Wrapper Config
â”‚   â””â”€logs/                               # æ—¥å¿—
â””â”€â”€ docs/                                 # å„ç±»æ–‡æ¡£
```

## è·¯å¾„é…ç½®è¯´æ˜

æœ¬ä»“åº“ä¸­çš„éƒ¨åˆ†é…ç½®æ–‡ä»¶åŒ…å«äº†ç¤ºä¾‹è·¯å¾„æ ‡è®° `<YOUR_MIHOMO_PATH>`ï¼Œåœ¨å®é™…ä½¿ç”¨å‰éœ€è¦å°†å…¶æ›¿æ¢ä¸ºæ‚¨æœ¬åœ°çš„å®é™…è·¯å¾„ã€‚

éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶åŒ…æ‹¬ï¼š
- winsw.xml
- Sync Mihomo Official Config.xml
- Sync Procider.xml
- sync-official-config-run.vbs
- sync-procider-run.vbs

è¯·å°† `<YOUR_MIHOMO_PATH>` æ›¿æ¢ä¸ºä½ å­˜æ”¾ mihomo çš„å®é™…ç›®å½•è·¯å¾„ã€‚

## é…ç½®è¯´æ˜

### ä¸»è¦ç‰¹æ€§

1. **æœåŠ¡åŒ–è¿è¡Œ**ï¼šä½¿ç”¨ WinSW å°† Mihomo æ³¨å†Œä¸º Windows æœåŠ¡ï¼Œå®ç°å¼€æœºè‡ªå¯å’Œåå°è¿è¡Œ
2. **Web UI æ§åˆ¶é¢æ¿**ï¼šå¯ç”¨ Zashboard æ§åˆ¶é¢æ¿ï¼Œå¯é€šè¿‡æµè§ˆå™¨ç®¡ç†
3. **TUN æ¨¡å¼**ï¼šå¯ç”¨ TUN æ¨¡å¼ï¼Œç½‘å¡åç§°è®¾ç½®ä¸º "Mihomo"
4. **è‡ªåŠ¨æ›´æ–°**ï¼šæ”¯æŒè®¢é˜…å’Œè§„åˆ™é›†è‡ªåŠ¨æ›´æ–°

### é…ç½®æ–‡ä»¶

#### main.yaml

è¿™æ˜¯ä¸»é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä¸»è¦é…ç½®ï¼š

- å…¨å±€é…ç½®
- å¤–éƒ¨æ§åˆ¶å™¨
- è®¢é˜…é…ç½®
- TUN é…ç½®
- DNS é…ç½®
- è§„åˆ™é›†é…ç½®
- ä»£ç†åˆ†ç»„é…ç½®
- è‡ªå®šä¹‰è§„åˆ™

## ä½¿ç”¨æ–¹æ³•

### ä¿®æ”¹é…ç½®

ç¼–è¾‘ `config/main.yaml` æ–‡ä»¶ï¼š

1. æ›¿æ¢è®¢é˜…é“¾æ¥([ç‚¹å‡»æŸ¥çœ‹å‚è€ƒ](https://github.com/MetaCubeX/mihomo/discussions/2433#discussioncomment-15265377)):
  ```yaml
  proxy-providers:
    Airport1: # åç§°å¯è‡ªå®šä¹‰
      url: 'æ­¤å¤„å¡«å…¥ä½ çš„è®¢é˜…é“¾æ¥ï¼ˆæ³¨æ„å¿…é¡»æ˜¯éé˜…åå³ç„šç±»å‹ï¼‰'
      <<: *Remote
      path: './proxy_provider/airport1.yaml'

    # è¯»å–æœ¬åœ°é…ç½®
    # Airport2:
    # <<: *Local
    # path: './proxy_provider/airport2.yaml'
    
  ```

2. æ ¹æ®éœ€è¦ä¿®æ”¹å…¶ä»–é…ç½®é¡¹

## WinSW æœåŠ¡æ–¹æ¡ˆ
### å®‰è£…æœåŠ¡

ä»¥ç®¡ç†å‘˜æƒé™å¯åŠ¨pwshï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æœåŠ¡ï¼š

```powershell
./script/winsw.exe install
```

### ç®¡ç†æœåŠ¡å‘½ä»¤

```powershell
# å¯åŠ¨æœåŠ¡
./winsw.exe start

# åœæ­¢æœåŠ¡
./winsw.exe stop

# é‡å¯æœåŠ¡
./winsw.exe restart

# å¸è½½æœåŠ¡
./winsw.exe uninstall
```

> ä¸ºæ–¹ä¾¿å¿«é€Ÿæ‰§è¡Œä»»åŠ¡ï¼Œå®‰è£…æœåŠ¡å
>
> ä½ å¯ä»¥é€‰ä¸­`start-mihomo.ps1`ã€`stop-mihomo.ps1`ã€`restart-mihomo.ps1`è¿™ä¸‰ä¸ªè„šæœ¬ï¼Œåˆ›å»ºå¿«æ·æ–¹å¼
>
> ç„¶åå°†å¿«æ·æ–¹å¼æ”¾åˆ°å¼€å§‹èœå•`C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\Microsoft\Windows\Start Menu\Programs`
>
> Windows10 è¿˜å¯ä»¥å°†å®ƒä»¬æ”¾ç½®åœ¨ç£è´´


### è®¿é—®æ§åˆ¶é¢æ¿

å¯åŠ¨æœåŠ¡åï¼Œå¯é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—® Zashboard æ§åˆ¶é¢æ¿ï¼š

http://127.0.0.1:9090/ui/zashboard/

## ç§»åŠ¨æ–‡ä»¶æ³¨æ„äº‹é¡¹

å¦‚æœéœ€è¦ç§»åŠ¨å¯æ‰§è¡Œæ–‡ä»¶æˆ–é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè¯·æ³¨æ„éœ€è¦é‡æ–°å®‰è£…æœåŠ¡ä»¥æ›´æ–°æ–‡ä»¶è·¯å¾„

> [!IMPORTANT]
> 
> æ³¨æ„ï¼šç§»åŠ¨ `winsw.exe` æ–‡ä»¶ä¼šå¯¼è‡´æœåŠ¡æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå› ä¸º Windows æœåŠ¡ä»æŒ‡å‘æ—§ä½ç½®çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å¿…é¡»é‡æ–°å®‰è£…æœåŠ¡æ‰èƒ½è§£å†³æ­¤é—®é¢˜ã€‚

## æ—¥å¿—ç®¡ç†

æœåŠ¡è¿è¡Œæ—¥å¿—ä¿å­˜åœ¨ `logs` ç›®å½•ä¸­ï¼ŒWinSW ä¼šè‡ªåŠ¨ç®¡ç†æ—¥å¿—æ–‡ä»¶çš„è½®è½¬å’Œæ¸…ç†ã€‚

## å…¶ä»–

<details>
<summary><strong>è„šæœ¬è¯´æ˜</strong></summary>

![](docs/20251218190551.jpg)

#### `sync-official-config.ps1` ä½¿ç”¨è¯´æ˜

è‡ªåŠ¨åŒæ­¥ [mihomo å®˜æ–¹ç¤ºä¾‹é…ç½®](https://raw.githubusercontent.com/MetaCubeX/mihomo/Alpha/docs/config.yaml) åˆ°æœ¬åœ° `config/otherfiles/offical_example_config.yaml`ï¼Œå¹¶è‡ªåŠ¨æäº¤ Git å˜æ›´ã€‚

- âœ… åŠŸèƒ½
  - ä»…å½“æ–‡ä»¶å†…å®¹å˜åŒ–æ—¶æ‰æäº¤
  - ç”Ÿæˆæ—¥å¿—ï¼š`script/logs/tracklog/sync-mihomo-config.log`
  - Windows æ¡Œé¢é€šçŸ¥ï¼ˆBurntToastï¼‰

- âš™ï¸ å‰ç½®æ¡ä»¶
  - **PowerShell 7+**
  - å·²å®‰è£…æ¨¡å—ï¼š`Install-Module BurntToast -Scope CurrentUser`
  - Git å·²é…ç½® `user.name` / `user.email`

- â–¶ï¸ è¿è¡Œ
  ```powershell
  pwsh -ExecutionPolicy Bypass -File .\script\sync-official-config.ps1
  ```

- ğŸ•’ è‡ªåŠ¨åŒ–ï¼ˆä»»åŠ¡è®¡åˆ’ç¨‹åºï¼‰
  - ç¨‹åºï¼š`wscript.exe`
  - å‚æ•°ï¼š`"<YOUR_MIHOMO_PATH>\script\sync-official-config-run.vbs"`
  - å‚è€ƒ: `script\Sync Mihomo Official Config.xml`

#### `sync-procider.ps1` ä½¿ç”¨è¯´æ˜

è‡ªåŠ¨æ‰«æ `config/proxy_provider` ç›®å½•ä¸­çš„æ‰€æœ‰ä»£ç†æä¾›å•†é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å…¶ä¸­çš„ä»£ç†ä¿¡æ¯æå–åˆ° `config/otherfiles/proxies.yaml` æ–‡ä»¶ä¸­ï¼Œä¾¿äºæŸ¥çœ‹å’Œè·Ÿè¸ªä»£ç†èŠ‚ç‚¹çš„å˜åŒ–ã€‚

- âœ… åŠŸèƒ½
  - è‡ªåŠ¨æ‰«æç›®å½•ä¸­çš„æ‰€æœ‰ YAML é…ç½®æ–‡ä»¶
  - æå–å„é…ç½®æ–‡ä»¶ä¸­çš„ä»£ç†èŠ‚ç‚¹ä¿¡æ¯
  - ç”Ÿæˆç»Ÿä¸€çš„ä»£ç†åˆ—è¡¨æ–‡ä»¶ `proxies.yaml`
  - æ¯”è¾ƒèŠ‚ç‚¹å˜åŒ–å¹¶ç”Ÿæˆæ—¥å¿—
  - Windows æ¡Œé¢é€šçŸ¥ï¼ˆBurntToastï¼‰

- âš™ï¸ å‰ç½®æ¡ä»¶
  - **PowerShell 7+**
  - å·²å®‰è£…æ¨¡å—ï¼š`Install-Module BurntToast -Scope CurrentUser`

- â–¶ï¸ è¿è¡Œ
  ```powershell
  pwsh -ExecutionPolicy Bypass -File .\script\sync-procider.ps1
  ```

- ğŸ•’ è‡ªåŠ¨åŒ–ï¼ˆä»»åŠ¡è®¡åˆ’ç¨‹åºï¼‰
  - ç¨‹åºï¼š`wscript.exe`
  - å‚æ•°ï¼š`"<YOUR_MIHOMO_PATH>\script\sync-procider-run.vbs"`
  - å‚è€ƒï¼š`script\Sync Procider.xml`

- ğŸ“ ç›¸å…³ç›®å½•
  - è¾“å…¥ç›®å½•ï¼š`config/proxy_provider/`ï¼ˆæ‰€æœ‰ `.yaml` æ–‡ä»¶ï¼‰
  - è¾“å‡ºæ–‡ä»¶ï¼š`config/otherfiles/proxies.yaml`
  - æ—¥å¿—æ–‡ä»¶ï¼š`script/logs/proxies-change.log`

> è„šæœ¬ä¾èµ–å½“å‰é¡¹ç›®ç»“æ„ï¼Œå‹¿ç§»åŠ¨ `script/` æˆ– `config/otherfiles/` ç›®å½•ã€‚
</details>

## å‚è€ƒ
1. [Aloxaf: Clash ä¸­ GeoSite åˆ†æµçš„æ­£ç¡®ä½¿ç”¨æ–¹å¼](https://www.aloxaf.com/2025/04/how_to_use_geosite/)
2. [yyhhyyyyyy: Mihomo è‡ªç”¨é…ç½®](https://iyyh.net/posts/mihomo-self-config)
3. [Sukka: æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆï¼Œæ€ä¹ˆåš â€”â€” è°ˆè°ˆ DNS æ³„æ¼ã€CDN è®¿é—®ä¼˜åŒ–ä¸ Fake IP](https://blog.skk.moe/post/lets-talk-about-dns-cdn-fake-ip/)
4. [fastoo: åˆ†äº«ä¸€ä»½è‡ªå·±ç»´æŠ¤çš„ å›½å†…ä¸»æµä¼ä¸šå·¥ä¿¡éƒ¨ ICP å¤‡æ¡ˆåŸŸååˆ—è¡¨](https://www.nodeseek.com/post-464238-1)

## ä½¿ç”¨çš„è§„åˆ™é›†
1. [Sukka Ruleset](https://github.com/SukkaW/Surge)
2. [TG-Twilight: AWAvenue ç§‹é£å¹¿å‘Šè§„åˆ™](https://github.com/TG-Twilight/AWAvenue-Ads-Rule)
3. [DustinWin: ruleset_geodata](http://github.com/DustinWin/ruleset_geodata)
4. [peiyingyao: Rule-for-OCD](https://github.com/peiyingyao/Rule-for-OCD)
5. [MetaCubeX: meta-rules-dat](https://github.com/MetaCubeX/meta-rules-dat/tree/meta)
6. [Loyalsoldier&Kwisma: clash-rules](https://github.com/Kwisma/clash-rules)
7. [fastoo: å›½å†…ä¸»æµä¼ä¸šå·¥ä¿¡éƒ¨ ICP å¤‡æ¡ˆåŸŸååˆ—è¡¨](https://www.nodeseek.com/post-464238-1)